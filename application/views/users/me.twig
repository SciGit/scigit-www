{% extends "base.twig" %}

{% block title "My Account" %}

{% block content %}

<div class="page-header">
	<h1>My Account</h1>
</div>

{%
set settings_fields = [
  {
    'label' : 'Receive email updates',
    'name' : 'email_updates',
    'id' : 'email_updates',
    'checked' : set_value('email_updates', not user.disable_email),
    'value' : '1',
    'type' : 'checkbox',
  },
  {
    'label' : 'Make profile private',
    'name' : 'private',
    'id' : 'private',
    'checked' : set_value('private', user.private),
    'value' : '1',
    'type' : 'checkbox',
  },
]
%}

{%
set profile_fields = [
	{
    'label' : 'Username',
		'name': 'username',
		'id': 'username',
		'value': set_value('username', user.username),
		'maxlength': 40,
		'size': 40,
    'class' : 'full-width-input',
    'type' : 'static',
	},
	{
    'label' : 'Email',
		'name': 'email',
		'id': 'email',
		'value': set_value('email', user.email),
		'maxlength': 40,
		'size': 40,
    'class' : 'full-width-input',
    'type' : 'email',
    'required' : 'true',
	},
	{
    'label' : 'Title',
		'name': 'title',
		'id': 'title',
		'value': set_value('title', user.title),
		'maxlength': 40,
		'size': 40,
    'class' : 'full-width-input',
    'type' : 'text',
	},
	{
    'label' : 'Organization',
		'name': 'organization',
		'id': 'organization',
		'value': set_value('organization', user.organization),
		'maxlength': 40,
		'size': 40,
    'class' : 'full-width-input',
    'type' : 'text',
	},
	{
    'label' : 'Location',
		'name': 'location',
		'id': 'location',
		'value': set_value('location', user.location),
		'maxlength': 40,
		'size': 40,
    'class' : 'full-width-input',
    'type' : 'text',
	},
	{
    'label' : 'Name',
		'name': 'name',
		'id': 'name',
		'value': set_value('name', user.fullname),
		'maxlength': 40,
		'size': 40,
    'class' : 'full-width-input',
    'type' : 'text',
	},
	{
    'label' : 'About',
		'name': 'about',
		'id': 'about',
		'value': set_value('about', user.about),
		'maxlength': 1024,
		'size': 1024,
    'class' : 'full-width-input',
    'type' : 'textarea',
	},
]
%}

{# Hidden password input to get rid of a bug on some browsers where the first
   password field is filled with some garbage data. #}
{%
set password_fields = [
  {
    'label': '',
    'name': 'hidden',
    'id': 'hidden',
    'type': 'password',
    'hidden': 'true',
  },
  {
    'label' : 'Current Password',
		'name': 'current_password',
		'id': 'current_password',
		'value': set_value('current_password'),
		'maxlength': 40,
		'size': 40,
    'class' : 'full-width-input',
    'type' : 'password',
    'required': 'true',
  },
  {
    'label' : 'New Password',
		'name': 'new_password',
		'id': 'new_password',
		'value': set_value('new_password'),
		'maxlength': 40,
		'size': 40,
    'class' : 'full-width-input',
    'type' : 'password',
    'required': 'true',
  },
  {
    'label' : 'Confirm New Password',
		'name': 'confirm_new_password',
		'id': 'confirm_new_password',
		'value': set_value('confirm_new_password'),
		'maxlength': 40,
		'size': 40,
    'class' : 'full-width-input',
    'type' : 'password',
    'required': 'true',
  },
]
%}

<ul class="nav nav-tabs">
  <li{% if form_name == 'settings' %} class="active"{% endif %}><a href="#settings" data-toggle="tab">Settings</a></li>
  <li{% if form_name == 'profile' %} class="active"{% endif %}><a href="#profile" data-toggle="tab">Profile</a></li>
  <li{% if form_name == 'password' %} class="active"{% endif %}><a href="#password" data-toggle="tab">Password</a></li>
</ul>

{% if message %}
  <div class="alert {{ success ? 'alert-success' : 'alert-error' }}">
    <button type="button" class="close" data-dismiss="alert">Ã—</button>
    {{ message }}
  </div>
{% endif %}

<div id="my-tab-content" class="tab-content">
  <div class="tab-pane fade in {% if form_name == 'settings' %}active{% endif %}" id="settings">
    {% include 'forms/generic.twig'
        with {'fields': settings_fields,
              'form' : {class: 'well'},
              'columns': [3, 9],
              'form_name': 'settings'} %}
  </div>
  <div class="tab-pane fade in {% if form_name == 'profile' %}active{% endif %}" id="profile">
    {% include 'forms/generic.twig'
      with {'fields': profile_fields,
            'form': {class: 'well'},
            'columns': [2, 8],
            'form_name': 'profile'} %}
  </div>
  <div class="tab-pane fade in {% if form_name == 'password' %}active{% endif %}" id="password">
    {% include 'forms/generic.twig'
      with {'fields': password_fields,
            'form': {class: 'well'},
            'columns': [2, 8],
            'form_name': 'password'} %}
  </div>
</div>

{% endblock %}
